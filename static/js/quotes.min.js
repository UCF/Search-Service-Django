function _regeneratorRuntime() { "use strict"; _regeneratorRuntime = function () { return i }; var u, i = {}, e = Object.prototype, s = e.hasOwnProperty, l = Object.defineProperty || function (e, t, r) { e[t] = r.value }, t = "function" == typeof Symbol ? Symbol : {}, n = t.iterator || "@@iterator", r = t.asyncIterator || "@@asyncIterator", o = t.toStringTag || "@@toStringTag"; function a(e, t, r) { return Object.defineProperty(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 }), e[t] } try { a({}, "") } catch (u) { a = function (e, t, r) { return e[t] = r } } function c(e, t, r, n) { var o, a, i, c, t = t && t.prototype instanceof m ? t : m, t = Object.create(t.prototype), n = new L(n || []); return l(t, "_invoke", { value: (o = e, a = r, i = n, c = f, function (e, t) { if (c === p) throw new Error("Generator is already running"); if (c === y) { if ("throw" === e) throw t; return { value: u, done: !0 } } for (i.method = e, i.arg = t; ;) { var r = i.delegate; if (r) { r = function e(t, r) { var n = r.method, o = t.iterator[n]; if (o === u) return r.delegate = null, "throw" === n && t.iterator.return && (r.method = "return", r.arg = u, e(t, r), "throw" === r.method) || "return" !== n && (r.method = "throw", r.arg = new TypeError("The iterator does not provide a '" + n + "' method")), v; n = d(o, t.iterator, r.arg); if ("throw" === n.type) return r.method = "throw", r.arg = n.arg, r.delegate = null, v; o = n.arg; return o ? o.done ? (r[t.resultName] = o.value, r.next = t.nextLoc, "return" !== r.method && (r.method = "next", r.arg = u), r.delegate = null, v) : o : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, v) }(r, i); if (r) { if (r === v) continue; return r } } if ("next" === i.method) i.sent = i._sent = i.arg; else if ("throw" === i.method) { if (c === f) throw c = y, i.arg; i.dispatchException(i.arg) } else "return" === i.method && i.abrupt("return", i.arg); c = p; r = d(o, a, i); if ("normal" === r.type) { if (c = i.done ? y : h, r.arg === v) continue; return { value: r.arg, done: i.done } } "throw" === r.type && (c = y, i.method = "throw", i.arg = r.arg) } }) }), t } function d(e, t, r) { try { return { type: "normal", arg: e.call(t, r) } } catch (e) { return { type: "throw", arg: e } } } i.wrap = c; var f = "suspendedStart", h = "suspendedYield", p = "executing", y = "completed", v = {}; function m() { } function g() { } function q() { } var t = {}, w = (a(t, n, function () { return this }), Object.getPrototypeOf), w = w && w(w(T([]))), x = (w && w !== e && s.call(w, n) && (t = w), q.prototype = m.prototype = Object.create(t)); function b(e) { ["next", "throw", "return"].forEach(function (t) { a(e, t, function (e) { return this._invoke(t, e) }) }) } function E(i, c) { var t; l(this, "_invoke", { value: function (r, n) { function e() { return new c(function (e, t) { !function t(e, r, n, o) { var a, e = d(i[e], i, r); if ("throw" !== e.type) return (r = (a = e.arg).value) && "object" == typeof r && s.call(r, "__await") ? c.resolve(r.__await).then(function (e) { t("next", e, n, o) }, function (e) { t("throw", e, n, o) }) : c.resolve(r).then(function (e) { a.value = e, n(a) }, function (e) { return t("throw", e, n, o) }); o(e.arg) }(r, n, e, t) }) } return t = t ? t.then(e, e) : e() } }) } function S(e) { var t = { tryLoc: e[0] }; 1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t) } function k(e) { var t = e.completion || {}; t.type = "normal", delete t.arg, e.completion = t } function L(e) { this.tryEntries = [{ tryLoc: "root" }], e.forEach(S, this), this.reset(!0) } function T(t) { if (t || "" === t) { var r, e = t[n]; if (e) return e.call(t); if ("function" == typeof t.next) return t; if (!isNaN(t.length)) return r = -1, (e = function e() { for (; ++r < t.length;)if (s.call(t, r)) return e.value = t[r], e.done = !1, e; return e.value = u, e.done = !0, e }).next = e } throw new TypeError(typeof t + " is not iterable") } return l(x, "constructor", { value: g.prototype = q, configurable: !0 }), l(q, "constructor", { value: g, configurable: !0 }), g.displayName = a(q, o, "GeneratorFunction"), i.isGeneratorFunction = function (e) { e = "function" == typeof e && e.constructor; return !!e && (e === g || "GeneratorFunction" === (e.displayName || e.name)) }, i.mark = function (e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, q) : (e.__proto__ = q, a(e, o, "GeneratorFunction")), e.prototype = Object.create(x), e }, i.awrap = function (e) { return { __await: e } }, b(E.prototype), a(E.prototype, r, function () { return this }), i.AsyncIterator = E, i.async = function (e, t, r, n, o) { void 0 === o && (o = Promise); var a = new E(c(e, t, r, n), o); return i.isGeneratorFunction(t) ? a : a.next().then(function (e) { return e.done ? e.value : a.next() }) }, b(x), a(x, o, "Generator"), a(x, n, function () { return this }), a(x, "toString", function () { return "[object Generator]" }), i.keys = function (e) { var t, r = Object(e), n = []; for (t in r) n.push(t); return n.reverse(), function e() { for (; n.length;) { var t = n.pop(); if (t in r) return e.value = t, e.done = !1, e } return e.done = !0, e } }, i.values = T, L.prototype = { constructor: L, reset: function (e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = u, this.done = !1, this.delegate = null, this.method = "next", this.arg = u, this.tryEntries.forEach(k), !e) for (var t in this) "t" === t.charAt(0) && s.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = u) }, stop: function () { this.done = !0; var e = this.tryEntries[0].completion; if ("throw" === e.type) throw e.arg; return this.rval }, dispatchException: function (r) { if (this.done) throw r; var n = this; function e(e, t) { return a.type = "throw", a.arg = r, n.next = e, t && (n.method = "next", n.arg = u), !!t } for (var t = this.tryEntries.length - 1; 0 <= t; --t) { var o = this.tryEntries[t], a = o.completion; if ("root" === o.tryLoc) return e("end"); if (o.tryLoc <= this.prev) { var i = s.call(o, "catchLoc"), c = s.call(o, "finallyLoc"); if (i && c) { if (this.prev < o.catchLoc) return e(o.catchLoc, !0); if (this.prev < o.finallyLoc) return e(o.finallyLoc) } else if (i) { if (this.prev < o.catchLoc) return e(o.catchLoc, !0) } else { if (!c) throw new Error("try statement without catch or finally"); if (this.prev < o.finallyLoc) return e(o.finallyLoc) } } } }, abrupt: function (e, t) { for (var r = this.tryEntries.length - 1; 0 <= r; --r) { var n = this.tryEntries[r]; if (n.tryLoc <= this.prev && s.call(n, "finallyLoc") && this.prev < n.finallyLoc) { var o = n; break } } var a = (o = o && ("break" === e || "continue" === e) && o.tryLoc <= t && t <= o.finallyLoc ? null : o) ? o.completion : {}; return a.type = e, a.arg = t, o ? (this.method = "next", this.next = o.finallyLoc, v) : this.complete(a) }, complete: function (e, t) { if ("throw" === e.type) throw e.arg; return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), v }, finish: function (e) { for (var t = this.tryEntries.length - 1; 0 <= t; --t) { var r = this.tryEntries[t]; if (r.finallyLoc === e) return this.complete(r.completion, r.afterLoc), k(r), v } }, catch: function (e) { for (var t = this.tryEntries.length - 1; 0 <= t; --t) { var r, n, o = this.tryEntries[t]; if (o.tryLoc === e) return "throw" === (r = o.completion).type && (n = r.arg, k(o)), n } throw new Error("illegal catch attempt") }, delegateYield: function (e, t, r) { return this.delegate = { iterator: T(e), resultName: t, nextLoc: r }, "next" === this.method && (this.arg = u), v } }, i } function asyncGeneratorStep(e, t, r, n, o, a, i) { try { var c = e[a](i), u = c.value } catch (e) { return void r(e) } c.done ? t(u) : Promise.resolve(u).then(n, o) } function _asyncToGenerator(c) { return function () { var e = this, i = arguments; return new Promise(function (t, r) { var n = c.apply(e, i); function o(e) { asyncGeneratorStep(n, t, r, o, a, "next", e) } function a(e) { asyncGeneratorStep(n, t, r, o, a, "throw", e) } o(void 0) }) } } var baseUrl = window.location.origin, csrftoken = document.querySelector("[name=csrfmiddlewaretoken]").value, programId = document.querySelector("[name=quote-section]").getAttribute("data-program-id"), activeQuotes = document.querySelectorAll(".active-quotes"), activeQuotesIds = [], relatedQuotesWrapper = (activeQuotes.forEach(function (e) { activeQuotesIds.push(e.getAttribute("data-quote-id")) }), document.querySelector("#related-quotes-wrapper")), modal = document.getElementById("activeQuoteModal"), modalTitle = modal.querySelector(".modal-title"), modalBody = modal.querySelector(".modal-body"), editModalSaveBtn = modal.querySelector("#editModalSaveBtn"), AllQuotes = [], fetchQuotes = function () { var e = _asyncToGenerator(_regeneratorRuntime().mark(function e() { var t; return _regeneratorRuntime().wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.prev = 0, e.next = 3, fetch(baseUrl + "/api/v1/marketing/quotes/"); case 3: if ((t = e.sent).ok) return e.next = 7, t.json(); e.next = 9; break; case 7: (t = e.sent) && AllQuotes.push.apply(AllQuotes, t.results); case 9: console.error("Failed to fetch quotes"), e.next = 15; break; case 12: e.prev = 12, e.t0 = e.catch(0), console.error("Error fetching quotes:", e.t0); case 15: case "end": return e.stop() } }, e, null, [[0, 12]]) })); return function () { return e.apply(this, arguments) } }(); fetchQuotes().then(function () { AllQuotes.forEach(function (e) { activeQuotesIds.includes(e.id.toString()) || (relatedQuotesWrapper.innerHTML += '\n      <div class="col-md-4">\n        <div class="card h-100">\n          <div class="card-header text-center">\n            ' + (e.image ? '<img src="' + e.image + '" class="card-img-top rounded-circle w-50" alt="...">' : "") + '\n          </div>\n          <div class="card-body">\n            <p class="card-text">' + e.quote_text + '</p>\n            <p class="card-text"><strong>' + e.source + "</strong>" + e.titles + '</p>\n          </div>\n          <div class="card-footer text-center">\n            <button class="btn" data-quote-id="' + e.id + '" id="addQuoteBtn"><span class="fa-xl fa-regular fa-square-plus me-2"></span>Attach Quote</button>\n          </div>\n        </div>\n      </div>\n    ') }) }), activeQuotes.forEach(function (u) { var e = u.querySelector(".active-quote-edit"), s = (u.querySelector(".active-quote-detach"), u.getAttribute("data-quote-id")); e.addEventListener("click", function () { var e = u.querySelector(".active-quotes-quoteSource").innerText, t = u.querySelector(".active-quotes-quoteText").innerHTML, r = u.querySelector(".active-quotes-quoteTitle").innerHTML; document.getElementById("quoteText").value = t, document.getElementById("quoteSource").value = e, document.getElementById("quoteTitle").value = r, $(modal).modal("show"), editModalSaveBtn.onclick = _asyncToGenerator(_regeneratorRuntime().mark(function e() { var t, r, n, o, a, i, c; return _regeneratorRuntime().wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (t = document.getElementById("quoteText").value, r = document.getElementById("quoteSource").value, n = document.getElementById("quoteTitle").value, o = document.getElementById("quoteImage").files[0], u.querySelector(".active-quotes-quoteText").innerHTML = t, u.querySelector(".active-quotes-quoteSource").innerHTML = "<strong>" + r + "<strong>", u.querySelector(".active-quotes-quoteTitle").innerHTML = n, o) { e.next = 29; break } return a = { quote_text: t, source: r, titles: n, tags: ["test"] }, e.prev = 9, e.next = 12, fetch(baseUrl + "/api/v1/marketing/quotes/" + s + "/", { method: "PUT", headers: { "Content-Type": "application/json", "X-CSRFToken": csrftoken }, body: JSON.stringify(a) }); case 12: if ((a = e.sent).ok) return e.next = 16, a.json(); e.next = 21; break; case 16: i = e.sent, console.log("Quote updated successfully:", i), $(modal).modal("hide"), e.next = 22; break; case 21: console.error("Failed to update quote"); case 22: e.next = 27; break; case 24: e.prev = 24, e.t0 = e.catch(9), console.error("Error updating quote:", e.t0); case 27: e.next = 55; break; case 29: if (o) return (i = new FormData).append("quote_text", t), i.append("source", r), i.append("titles", n), i.append("tags", "test"), i.append("image", o), e.prev = 36, e.next = 39, fetch(baseUrl + "/api/v1/marketing/quotes/" + s + "/", { method: "PATCH", headers: { "X-CSRFToken": csrftoken }, body: i }); e.next = 55; break; case 39: if ((c = e.sent).ok) return e.next = 43, c.json(); e.next = 49; break; case 43: c = e.sent, u.querySelector(".active-quotes-quoteImage").src = "" + c.image, document.getElementById("quoteImage").value = "", $(modal).modal("hide"), e.next = 50; break; case 49: console.error("Failed to update quote"); case 50: e.next = 55; break; case 52: e.prev = 52, e.t1 = e.catch(36), console.error("Error updating quote:", e.t1); case 55: case "end": return e.stop() } }, e, null, [[9, 24], [36, 52]]) })) }) }), modal.querySelector(".btn-close").addEventListener("click", function () { $("#activeQuoteModal").modal("hide") });
