{% extends 'base-bootstrap.html' %}
{% block body %}
<div class="container-fluid mt-4">
  <div class="row">
    <div class="col-lg-2 order-lg-2">
      <div class="card mt-2 mt-md-5 mb-3 sticky-lg-top">
        <div class="card-body">
          <dl class="mb-4">
            <dt>Created:</dt>
            <dd>Nov 1, 2023</dd>
            <dt>Updated:</dt>
            <dd>Nov 1, 2023</dd>
            <dt>Last Updated User:</dt>
            <dd>Webcom</dd>
          </dl>
          <input type="submit" form="program-form" class="btn btn-success" value="Save Changes">
        </div>
      </div>
    </div>
    <div class="col-lg-6 offset-lg-2 order-lg-1">
      <h2 class="heading-underline">{{ object.name }}</h2>
      <form id="program-form" name="program-form" method="POST">
        {% csrf_token %}
        <h3 class="h4 mb-4">Descriptions</h3>
        <div class="row">
          <div class="col-md-4">
            <h4 class="h6">Custom Description</h4>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus aliquam mauris eget sapien cursus, ac gravida turpis sodales. Proin at aliquam quam, nec ornare massa. Nunc nec est velit. Etiam malesuada ullamcorper lacus, ac sagittis elit sagittis id. Nulla rutrum nibh id nisl consequat, vel ornare ante imperdiet. Donec facilisis magna nec enim feugiat ultricies. Nulla purus ex, dapibus commodo vehicula vel, condimentum non tellus. Aliquam ac sapien nibh. Vivamus sagittis blandit odio quis convallis. Vivamus non sapien aliquet, imperdiet turpis fringilla, tempus ipsum. Phasellus lobortis est odio, non bibendum mauris placerat nec. Sed lobortis augue nec libero ultricies, eu fringilla leo facilisis.</p>
          </div>
          <div class="col-md-8">
            {{ form.custom_description }}
          </div>
        </div>
        <h4 class="h6">Catalog Descriptions</h4>
        <table class="table">
          <thead>
              <tr>
                  <th scope="col">Description Type</th>
                  <th scope="col">Source</th>
                  <th scope="col">Exists</th>
                  <th scope="col">Actions</th>
              </tr>
          </thead>
          <tbody>
      {% for description_name, description in descriptions.items %}
          <tr>
              <td>{{ description_name }}</td>
              <td>{{ description.explanation }}</td>
              <td>
                  {% if description.description != "" %}
                  <span class="fa fa-circle-check text-success"></span><span class="sr-only">Exists</span>
                  {% else %}
                  <span class="fa fa-circle-cross text-error"></span><span class="sr-only">Does not exist</span>
                  {% endif %}
              </td>
              <td>
                  <a class="btn btn-sm btn-success" href="#preview" data-bs-toggle="modal" data-bs-target="#{{ description_name|slugify }}-modal">
                      <span class="fa fa-search"></span> Preview
                  </a>
              </td>
          </tr>
      {% endfor %}
          </tbody>
        </table>


      </form>
      <hr class="my-5">
      <h2>Read-only Fields</h2>
      <dl class="row">
          {% for field, value in read_only_fields.items %}
          <dt class="col-6 col-sm-3">{{ field }}: </dt>
          <dd class="col-6 col-sm-9">
              {% if field in 'Colleges,Departments' %}
                  <ul class="list-unstyled">
                  {% for v in value.all %}
                      <li class="list-item">{{ v }}</li>
                  {% endfor %}
                  </ul>
              {% elif field == 'Catalog URL' %}
                  <a href="{{ value }}" target="_blank" rel="nofollow">{{ value }}</a>
              {% elif field in 'Active,Valid' %}
                  {% if value == 'True' %}
                  <span class="fa fa-circle-check text-success" aria-hidden="True"></span>
                  {% else %}
                  <span class="fa fa-circle-check text-success" aria-hidden="True"></span>
                  {% endif %}
              {% else %}
                  {{ value }}
              {% endif %}
          </dd>
          {% endfor %}
      </dl>
    </div>
    {% for description_name, description in descriptions.items %}
    <div class="modal fade" id="{{ description_name|slugify }}-modal" tabindex="-1" role="dialog" aria-labelledby="{{ description_name|slugify }}-label" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="{{ description_name|slugify }}-label">{{ description_name }} Preview</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-5">
              {{ description.description|safe }}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endfor %}
{% endblock %}
{% block scripts %}
  {{ block.super }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.0/tinymce.min.js"></script>
  <script>
    tinymce.init({
      selector: '.wysiwyg',
      browser_spellcheck: true,
      plugins: 'link autoresize lists',
      // valid elems/styles configuration below should match with
      // BLEACH_ALLOWED_[] settings in settings_local.py
      valid_elements: 'p[style],span[style],br,strong/b,em/i,u,a[href|title|style|alt|target=_blank],ul,ol,li',
      valid_styles: {
        p: 'font-weight,text-decoration',
        span: 'font-weight,text-decoration',
        a: 'font-weight,text-decoration'
      },
      statusbar: false,
      menubar: false,
      toolbar: 'bold italic underline | bullist numlist | link',
      autoresize_bottom_margin: 10,
      min_height: 400,
      theme: 'silver'
    });
  </script>
{% endblock %}
